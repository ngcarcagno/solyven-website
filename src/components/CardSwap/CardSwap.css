.card-swap-container {
  position: relative; /* allow wrapping container to position it centrally */
  margin: 0 auto;
  transform: none;
  transform-origin: center center;
  perspective: 900px;
  overflow: visible;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* The outer wrapper (added in MissionVision) should be a positioned parent so we can
   absolutely anchor the visual stack on desktop while keeping mobile centered. */
.card-swap-outer {
  position: relative;
}

/* Visual nudge so the card stack appears anchored lower (cards come from below) */
.card-swap-container.shift-down,
.card-swap-outer.shift-down {
  transform: translateY(22%); /* moved 20% further down */
}

.card {
  position: absolute;
  top: 50%;
  left: 50%;
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  background: transparent;
  overflow: hidden;
  border-radius: 16px;

  transform-style: preserve-3d;
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-origin: center center;
  /* smooth fallback if GSAP isn't available yet */
  transition: transform 180ms ease-out;
}

.card:hover {
  /* progressive enhancement when a CSS hover scale var is provided */
  transform: var(--card-hover-transform, none);
}

@media (max-width: 768px) {
  .card-swap-container {
    /* Keep transform explicitly none so GSAP-managed transforms work reliably on mobile */
    transform: none;
  }
}

@media (max-width: 480px) {
  .card-swap-container {
    /* Keep transform explicitly none so GSAP-managed transforms work reliably on narrow screens */
    transform: none;
  }
}

/* Desktop (restore anchored layout similar to previous behavior) */
@media (min-width: 769px) {
  /* ensure the outer wrapper is the positioning context */
  .card-swap-outer {
    position: relative;
  }

  .card-swap-outer .card-swap-container {
    position: absolute;
    right: 4%;
    bottom: 6vh;
    margin: 0;
    transform-origin: bottom right;
    /* small visual offset to match previous design */
    transform: translate(5%, 30%); /* moved 20% further down */
    display: block;
  }

  /* When runtime detects potential overlap, reduce the visual translation and lift the bottom slightly
     to keep the cards from intruding into section title area. This is toggled by MissionVision logic. */
  .card-swap-outer.avoid-overlap .card-swap-container,
  .card-swap-outer.avoid-overlap {
    transform: translate(2%, 18%); /* moved 20% further down */
    bottom: 4vh;
  }

  /* On desktop the shift-down visual nudge should be minimal (cards anchored lower already) */
  .card-swap-outer.shift-down .card-swap-container,
  .card-swap-outer.shift-down {
    transform: translate(5%, 40%);
  }
}

/* Target small, short phones (example: iPhone 6/7/8 = 375x667) and similar
   viewports: push the card stack further down so it doesn't overlap the
   section title/subtitle. We target both width and height to avoid applying
   this rule to narrow but very tall screens. */
@media only screen and (max-width: 375px) and (max-height: 700px) {
  .card-swap-outer.shift-down {
    /* push the whole outer wrapper down more aggressively on small phones */
    transform: translateY(38%);
    /* add a tiny top margin for extra breathing room when transforms are ignored */
    margin-top: 8px;
  }

  /* When the inner container also has the shift-down class, make sure it
     doesn't counteract the outer movement. Prefer outer transform here. */
  .card-swap-container.shift-down {
    transform: none;
  }
}
